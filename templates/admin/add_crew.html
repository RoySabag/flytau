{% extends 'admin/base.html' %}

{% block admin_content %}
<div class="card shadow-sm border-0">
    <div class="card-header bg-transparent border-0 py-3 d-flex justify-content-between align-items-center">
        <h4 class="mb-0 fw-bold text-primary"><i class="bi bi-person-plus-fill me-2"></i>Add New Crew Member</h4>
    </div>
    <div class="card-body p-4">
        <form method="POST" action="{{ url_for('admin.add_crew') }}" class="needs-validation" novalidate>

            <h6 class="text-uppercase fw-bold text-muted mb-3">Personal Details</h6>
            <div class="row g-3 mb-4">
                <div class="col-md-6">
                    <label for="id_number" class="form-label">ID Number</label>
                    <input type="text" class="form-control" id="id_number" name="id_number" required>
                </div>
                <div class="col-md-6">
                    <label for="phone_number" class="form-label">Phone Number</label>
                    <input type="text" class="form-control" id="phone_number" name="phone_number" required>
                </div>
                <div class="col-md-6">
                    <label for="first_name" class="form-label">First Name</label>
                    <input type="text" class="form-control" id="first_name" name="first_name" required>
                </div>
                <div class="col-md-6">
                    <label for="last_name" class="form-label">Last Name</label>
                    <input type="text" class="form-control" id="last_name" name="last_name" required>
                </div>
            </div>

            <h6 class="text-uppercase fw-bold text-muted mb-3">Address & Employment</h6>
            <div class="row g-3 mb-4">
                <div class="col-md-4">
                    <label for="city" class="form-label">City</label>
                    <input type="text" class="form-control" id="city" name="city" required>
                </div>
                <div class="col-md-4">
                    <label for="street" class="form-label">Street</label>
                    <input type="text" class="form-control" id="street" name="street" required>
                </div>
                <div class="col-md-4">
                    <label for="house_no" class="form-label">House No.</label>
                    <input type="text" class="form-control" id="house_no" name="house_no" required>
                </div>
                <div class="col-md-6">
                    <label for="start_date" class="form-label">Employment Start Date</label>
                    <input type="date" class="form-control" id="start_date" name="start_date" required>
                </div>
                <div class="col-md-6">
                    <label for="password" class="form-label">Initial Password</label>
                    <input type="password" class="form-control" id="password" name="password" required>
                </div>
            </div>

            <h6 class="text-uppercase fw-bold text-muted mb-3">Role Configuration</h6>
            <div class="row g-3 mb-4">
                <div class="col-md-6">
                    <label for="role_id" class="form-label">Role</label>
                    <select class="form-select" id="role_id" name="role_id" required onchange="togglePilotOptions()">
                        <option value="" selected disabled>Select Role...</option>
                        <option value="Pilot">Pilot</option>
                        <option value="Flight Attendant">Flight Attendant</option>
                    </select>
                </div>
                <div class="col-md-6" id="pilot_options" style="display: none;">
                    <label class="form-label d-block">&nbsp;</label>
                    <div class="form-check mt-2">
                        <input class="form-check-input" type="checkbox" id="long_haul" name="long_haul" value="1">
                        <label class="form-check-label" for="long_haul">
                            Long Haul Certified
                        </label>
                    </div>
                </div>
            </div>

            <div class="d-flex justify-content-end gap-2">
                <a href="{{ url_for('admin.dashboard') }}" class="btn btn-outline-secondary">Cancel</a>
                <button type="submit" class="btn btn-primary px-4"><i class="bi bi-save me-2"></i>Save Employee</button>
            </div>
        </form>
    </div>
</div>

<script>
    function togglePilotOptions() {
        const role = document.getElementById('role_id').value;
        const pilotOptions = document.getElementById('pilot_options');
        // Role is now Pilot or Flight Attendant string
        if (role === 'Pilot' || role === 'Flight Attendant') {
            pilotOptions.style.display = 'block';
        } else {
            pilotOptions.style.display = 'none';
            // Uncheck if hidden
            document.getElementById('long_haul').checked = false;
        }
    }
</script>
{% endblock %}